(()=>{var e=typeof browser<"u"?browser:typeof chrome<"u"?chrome:null;if(!e)throw new Error("browser-polyfill: No extension API namespace found (neither browser nor chrome).");var r=typeof browser>"u"&&typeof chrome<"u";function n(t,u){return(...o)=>{try{let s=u.apply(t,o);if(s&&typeof s.then=="function")return s}catch{}return new Promise((s,i)=>{u.apply(t,[...o,(...l)=>{e.runtime&&e.runtime.lastError?i(new Error(e.runtime.lastError.message)):s(l.length<=1?l[0]:l)}])})}}var a={};a.runtime={sendMessage(...t){return r?n(e.runtime,e.runtime.sendMessage)(...t):e.runtime.sendMessage(...t)},onMessage:e.runtime.onMessage,getURL(t){return e.runtime.getURL(t)},openOptionsPage(){return r?n(e.runtime,e.runtime.openOptionsPage)():e.runtime.openOptionsPage()},get id(){return e.runtime.id}};a.storage={local:{get(...t){return r?n(e.storage.local,e.storage.local.get)(...t):e.storage.local.get(...t)},set(...t){return r?n(e.storage.local,e.storage.local.set)(...t):e.storage.local.set(...t)},clear(...t){return r?n(e.storage.local,e.storage.local.clear)(...t):e.storage.local.clear(...t)},remove(...t){return r?n(e.storage.local,e.storage.local.remove)(...t):e.storage.local.remove(...t)}}};a.tabs={create(...t){return r?n(e.tabs,e.tabs.create)(...t):e.tabs.create(...t)},query(...t){return r?n(e.tabs,e.tabs.query)(...t):e.tabs.query(...t)},remove(...t){return r?n(e.tabs,e.tabs.remove)(...t):e.tabs.remove(...t)},update(...t){return r?n(e.tabs,e.tabs.update)(...t):e.tabs.update(...t)},get(...t){return r?n(e.tabs,e.tabs.get)(...t):e.tabs.get(...t)},getCurrent(...t){return r?n(e.tabs,e.tabs.getCurrent)(...t):e.tabs.getCurrent(...t)}};var c=document.createElement("script");c.setAttribute("src",a.runtime.getURL("nostr.build.js"));document.body.appendChild(c);window.addEventListener("message",async t=>{if(t.source!==window)return;let u=["getPubKey","signEvent","getRelays","nip04.encrypt","nip04.decrypt","nip44.encrypt","nip44.decrypt","replaceURL"],{kind:o,reqId:s,payload:i}=t.data;u.includes(o)&&(i=await a.runtime.sendMessage({kind:o,payload:i,host:window.location.host}),o=`return_${o}`,window.postMessage({kind:o,reqId:s,payload:i},window.location.origin))});})();
